jQuery(document).ready(function(){new jBoxPlugin("Image",{src:"href",gallery:"data-jbox-image",imageLabel:"title",imageFade:360,imageSize:"contain",target:jQuery(window),attach:jQuery("[data-jbox-image]"),fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"button",closeButton:!0,overlay:!0,animation:"zoomIn",preventDefault:!0,width:"100%",height:"100%",adjustDistance:{top:40,right:5,bottom:40,left:5},_onInit:function(){this.images=this.currentImage={},this.imageZIndex=1,this.attachedElements&&jQuery.each(this.attachedElements,function(i,t){if(t=jQuery(t),!t.data("jBox-image-gallery")){var e=t.attr(this.options.gallery)||"default";!this.images[e]&&(this.images[e]=[]),this.images[e].push({src:t.attr(this.options.src),label:t.attr(this.options.imageLabel)||""}),"title"==this.options.imageLabel&&t.removeAttr("title"),t.data("jBox-image-gallery",e),t.data("jBox-image-id",this.images[e].length-1)}}.bind(this));var i=function(i,t,e,o,n){if(!jQuery("#jBox-image-"+i+"-"+t).length){{var a=jQuery("<div/>",{id:"jBox-image-"+i+"-"+t,"class":"jBox-image-container"+(n?" jBox-image-not-found":"")}).css({backgroundImage:n?"":'url("'+this.images[i][t].src+'")',backgroundSize:this.options.imageSize,opacity:o?1:0,zIndex:e?0:this.imageZIndex++}).appendTo(this.content);jQuery("<div/>",{id:"jBox-image-label-"+i+"-"+t,"class":"jBox-image-label"+(o?" active":"")}).html(this.images[i][t].label).click(function(){$(this).toggleClass("expanded")}).appendTo(this.imageLabel)}!o&&!e&&a.animate({opacity:1},this.options.imageFade)}}.bind(this),t=function(i,t){jQuery(".jBox-image-label.active").removeClass("active expanded"),jQuery("#jBox-image-label-"+i+"-"+t).addClass("active")};this.showImage=function(e){if("open"!=e){var o=this.currentImage.gallery,n=this.currentImage.id+(1*("prev"==e)?-1:1);n=n>this.images[o].length-1?0:0>n?this.images[o].length-1:n}else{var o=this.source.data("jBox-image-gallery"),n=this.source.data("jBox-image-id");jQuery(".jBox-image-pointer-prev, .jBox-image-pointer-next").css({display:this.images[o].length>1?"block":"none"})}this.currentImage={gallery:o,id:n},jQuery("#jBox-image-"+o+"-"+n).length?(jQuery("#jBox-image-"+o+"-"+n).css({zIndex:this.imageZIndex++,opacity:0}).animate({opacity:1},"open"==e?0:this.options.imageFade),t(o,n)):(this.wrapper.addClass("jBox-image-loading"),jQuery('<img src="'+this.images[o][n].src+'"/>').each(function(){var e=new Image;e.onload=function(){i(o,n,!1),t(o,n),this.wrapper.removeClass("jBox-image-loading")}.bind(this),e.onerror=function(){i(o,n,!1,null,!0),t(o,n),this.wrapper.removeClass("jBox-image-loading")}.bind(this),e.src=this.images[o][n].src}.bind(this)));var a=n+1;a=a>this.images[o].length-1?0:0>a?this.images[o].length-1:a,!jQuery("#jBox-image-"+o+"-"+a).length&&jQuery('<img src="'+this.images[o][a].src+'"/>').each(function(){var t=new Image;t.onload=function(){i(o,a,!0)}.bind(this),t.onerror=function(){i(o,a,!0,null,!0)}.bind(this),t.src=this.images[o][a].src}.bind(this))}},_onCreated:function(){this.imageLabel=jQuery("<div/>",{"class":"jBox-image-label-container"}).appendTo(this.wrapper),this.imageLabel.append(jQuery("<div/>",{"class":"jBox-image-pointer-prev",click:function(){this.showImage("prev")}.bind(this)})).append(jQuery("<div/>",{"class":"jBox-image-pointer-next",click:function(){this.showImage("next")}.bind(this)}))},_onOpen:function(){jQuery(document).on("keyup.jBox-Image-"+this.id,function(i){37==i.keyCode&&this.showImage("prev"),39==i.keyCode&&this.showImage("next")}.bind(this)),this.showImage("open")},_onClose:function(){jQuery(document).off("keyup.jBox-Image-"+this.id)},_onCloseComplete:function(){this.wrapper.find(".jBox-image-container").css("opacity",0)}})});